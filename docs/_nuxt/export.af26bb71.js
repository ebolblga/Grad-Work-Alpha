import v from"./Icon.0977cbe2.js";import{_ as w}from"./my-button.410ab7ea.js";import{u as y}from"./composables.a9e745a7.js";import{t as i}from"./subjectParsing.7a17cc8c.js";import{N as C}from"./navbar.123db5b5.js";import{a as E,r as I,o as h,j,J as d,F as n,G as u,q as p}from"./entry.17c4e04f.js";import"./config.21baf810.js";const A={class:"h-screen flex flex-col"},O={class:"h-[92vh] p-5 flex justify-center"},T={class:"w-[40%] flex flex-col my-auto min-w-[360px]"},R=d("p",{class:"text-lg font-black"}," Экспорт расписания: ",-1),D=d("div",{class:"w-full h-0 border border-[#764462] mb-7"},null,-1),F=E({__name:"export",setup(U){y({title:"Экспортировать расписание"});const o=JSON.parse(localStorage.getItem("subjectsJSON")||""),c=I(localStorage.getItem("group")||"");function _(){let l=`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//MSUT "STANKIN"//Schedule//RU

`;for(let t=0;t<o.length;t++)for(let r=0;r<o[t].dates.length;r++){const x=o[t].type.replace("Лекции","Лекция").replace("Cеминары","Cеминар").replace("Лабораторные занятия","Лабораторное занятие"),b=(o[t].type==="Лабораторные занятия"?i.get(o[t].time+8):i.get(o[t].time)).split(" - "),S=o[t].dates[r].split("T");let m=new Date(S[0]+"T"+b[0]),f=new Date(S[0]+"T"+b[1]);m.setHours(m.getHours()+25),f.setHours(f.getHours()+25),l+=`BEGIN:VEVENT
UID:${t.toString()+r.toString()}
DTSTART:${m.toISOString()}
DTEND:${f.toISOString()}
SUMMARY:${o[t].name}
DESCRIPTION:${x+": "+o[t].groups.join(", ")+" "+o[t].subgroup}
LOCATION:${o[t].location}
END:VEVENT

`}l+="END:VCALENDAR";const e=new Blob([l],{type:"text/ics;charset=UTF-8"}),a=window.URL.createObjectURL(e),s=document.createElement("a");s.setAttribute("href",a),s.setAttribute("download",c.value!=""?c.value+".ics":"schedule.ics"),s.click()}function N(){const l=[['"Группа или преподователь',"Подгруппа","Предмет","Тип занятия","Кабинет","Время","URL","Строка дат","Даты"],...o.map(t=>[t.groups.join(", "),t.subgroup,t.name,t.type,t.location,t.type==="Лабораторные занятия"?i.get(t.time+8):i.get(t.time),t.url,t.dateStr,t.dates.join(" ")])].map(t=>t.join('","')).join(`"
"`),e=new Blob([l],{type:"text/csv;charset=UTF-8"}),a=window.URL.createObjectURL(e),s=document.createElement("a");s.setAttribute("href",a),s.setAttribute("download",c.value!=""?c.value+".csv":"schedule.csv"),s.click()}function g(){const l="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(o,null,"	")),e=document.createElement("a");e.setAttribute("href",l),e.setAttribute("download",c.value!=""?c.value+".json":"schedule.json"),document.body.appendChild(e),e.click(),e.remove()}function V(){}return(l,e)=>{const a=v,s=w;return h(),j("div",A,[d("div",O,[d("div",T,[n(s,{onClick:e[0]||(e[0]=t=>void 0),class:"mb-14 w-full"},{default:u(()=>[p("[WIP] Импортировать JSON"),n(a,{class:"ml-5 my-auto",name:"bi:filetype-json",size:"18px"})]),_:1}),R,D,n(s,{onClick:e[1]||(e[1]=t=>g()),class:"mb-7 w-full"},{default:u(()=>[p("Экспортировать JSON"),n(a,{class:"ml-5 my-auto",name:"bi:filetype-json",size:"18px"})]),_:1}),n(s,{onClick:e[2]||(e[2]=t=>N()),class:"mb-7 w-full"},{default:u(()=>[p("Экспортировать CSV"),n(a,{class:"ml-5 my-auto",name:"bi:filetype-csv",size:"18px"})]),_:1}),n(s,{onClick:e[3]||(e[3]=t=>_()),class:"mb-7 w-full"},{default:u(()=>[p("Экспортировать ICS"),n(a,{class:"ml-5 my-auto",name:"uil:calender",size:"18px"})]),_:1})])]),n(C)])}}});export{F as default};
